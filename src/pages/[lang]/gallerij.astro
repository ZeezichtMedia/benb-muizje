---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/common/Navbar.astro';
import Footer from '../../components/common/Footer.astro';
import MasonryGallery from '../../components/common/MasonryGallery.astro';

import { useTranslations } from '../../i18n/ui';

export const prerender = true;

export async function getStaticPaths() {
  const pages = await getCollection('site');
  
  const paths = pages
    .filter(page => {
       const [lang, slug] = page.slug.split('/');
       return lang !== 'nl' && ['gallerij', 'gallery', 'galerie'].includes(slug!);
    })
    .map(page => {
      const [lang] = page.slug.split('/');
      return { params: { lang }, props: { page } };
    });

  return paths;
}

const { lang } = Astro.params;
const { page } = Astro.props;
const { data } = page;
const currentLang = (lang as 'nl' | 'en' | 'de') || 'nl';
const t = useTranslations(currentLang);
---

<Layout title={data.title} description={data.description} lang={currentLang}>
  <Navbar />
  <main class="pt-24 md:pt-36 bg-brand-light min-h-screen">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <!-- Collage Hero -->
        <!-- Stacked Hero: Centered Text + Image Row -->
        <div class="text-center max-w-4xl mx-auto mb-16">
             <h1 class="text-4xl md:text-6xl font-heading font-black text-brand-green mb-6 leading-tight animate-slide-up">
                <span class="font-['Caveat'] text-5xl md:text-6xl text-brand-green/70 block mb-4 -rotate-1">{t('hero.gallery.subtitle')}</span>
                {data.title}
             </h1>
             <p class="text-lg md:text-xl text-brand-dark/80 font-medium leading-relaxed animate-slide-up delay-100 max-w-2xl mx-auto">
                {data.description}
             </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-16 animate-fade-in delay-200">
             <div class="relative h-64 md:h-80 rounded-3xl overflow-hidden shadow-lg group transform hover:-translate-y-2 transition-all duration-500">
                 <img src="/images/exterior-1.jpg" alt="Exterieur" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" />
                 <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-60 group-hover:opacity-40 transition-opacity"></div>
             </div>
             <div class="relative h-64 md:h-80 rounded-3xl overflow-hidden shadow-lg group transform hover:-translate-y-2 transition-all duration-500 delay-100">
                 <img src="/images/garden.jpg" alt="Tuin" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" />
                 <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-60 group-hover:opacity-40 transition-opacity"></div>
             </div>
             <div class="relative h-64 md:h-80 rounded-3xl overflow-hidden shadow-lg group transform hover:-translate-y-2 transition-all duration-500 delay-200">
                 <img src="/images/hero.jpg" alt="Sfeer" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" />
                 <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-60 group-hover:opacity-40 transition-opacity"></div>
             </div>
        </div>
        
        {data.gallery && (
          <div class="animate-slide-up delay-200">
            <MasonryGallery images={data.gallery} />
          </div>
        )}
    </div>
  </main>
  <Footer />
</Layout>
