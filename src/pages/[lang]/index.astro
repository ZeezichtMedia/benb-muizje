---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/common/Navbar.astro';
import Footer from '../../components/common/Footer.astro';
import Hero from '../../components/home/Hero.astro';
import About from '../../components/home/About.astro';
import Features from '../../components/home/Features.astro';
import Location from '../../components/home/Location.astro';

import Highlights from '../../components/home/Highlights.astro';
import Reviews from '../../components/home/Reviews.astro';
import CTA from '../../components/home/CTA.astro';

export async function getStaticPaths() {
  const pages = await getCollection('site');
  
  const paths = pages
    .filter(page => {
      const parts = page.slug.split('/');
      return parts.length === 2 && parts[1] === 'home';
    })
    .map(page => {
      const [lang] = page.slug.split('/');
      return { params: { lang }, props: { page } };
    });

  return paths;
}

const { lang } = Astro.params;
const { page } = Astro.props;
const { data } = page;
---

<Layout title={data.title} description={data.description} lang={lang || 'nl'}>
	<Navbar />
	<main>
		{data.hero && <Hero data={data.hero} />}
        {data.highlights && <Highlights data={data.highlights} />}
		{data.about && <About data={data.about} />}
        {data.features && <Features data={data.features} />}
        {data.reviews && <Reviews data={data.reviews} />}
        {data.location && <Location data={data.location} />}
        <CTA />
	</main>
	<Footer />
</Layout>
