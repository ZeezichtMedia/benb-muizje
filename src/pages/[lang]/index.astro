---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/common/Navbar.astro';
import Footer from '../../components/common/Footer.astro';
import Hero from '../../components/home/Hero.astro';
import About from '../../components/home/About.astro';
import Features from '../../components/home/Features.astro';
import Location from '../../components/home/Location.astro';

import Highlights from '../../components/home/Highlights.astro';
import Reviews from '../../components/home/Reviews.astro';
import CTA from '../../components/home/CTA.astro';

const { lang } = Astro.params;
const currentLang = lang as 'nl' | 'en' | 'de';

if (!['en', 'de'].includes(currentLang)) {
  return Astro.redirect('/');
}

const pages = await getCollection('site');
const page = pages.find(p => p.slug === `${currentLang}/home`);

if (!page) {
  return Astro.redirect('/');
}

const { data } = page;
---

<Layout title={data.title} description={data.description} lang={lang || 'nl'}>
	<Navbar />
	<main>
		{data.hero && <Hero data={data.hero} />}
        {data.highlights && <Highlights data={data.highlights} />}
		{data.about && <About data={data.about} />}
        {data.features && <Features data={data.features} />}
        {data.reviews && <Reviews data={data.reviews} />}
        {data.location && <Location data={data.location} />}
        <CTA />
	</main>
	<Footer />
</Layout>
